import{w as H,a as d,v as F,p as e}from"./chunk-UH6JLGW7-DB7KfY1H.js";import{b as I,o as g}from"./api-Cr5uWYEN.js";import{a as R}from"./card-CF0P5cGQ.js";import{B as N}from"./button-DQc83rjE.js";import{D as _,a as q,b as z}from"./dialog-B_vhg04E.js";import{H as B}from"./Header-DGBBqV3K.js";import{l as E}from"./index-CA1CrNgP.js";import{p as U}from"./printBill-DnXLfvfh.js";import{c as w}from"./createLucideIcon-DlhUvwdl.js";import"./Combination-Dov-rLQ-.js";import"./index-BZlCCt0w.js";import"./index-C5gdAslh.js";/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],V=w("file-text",L);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],K=w("printer",W);function O(){const[b,m]=d.useState([]),h=d.useCallback(p=>{m(o=>o.filter(n=>n.id!==p))},[]),i=d.useCallback(p=>{const o=Math.random().toString(36).slice(2);m(n=>[{id:o,message:p},...n]),setTimeout(()=>h(o),4e3)},[h]);return{toasts:b,push:i,remove:h}}const Z=()=>{var y;const b=d.useRef(null),m=I.defaults.baseURL||"http://localhost:3000",{push:h}=O(),[i,p]=d.useState({totalOrders:0,pending:0,preparing:0,completed:0,cancelled:0}),[o,n]=d.useState([]),[a,x]=d.useState(null),[G,v]=d.useState(!1),[j,C]=d.useState(""),S=async()=>{try{const s=(await g.getAll()).data.map(r=>({...r,items:r.items||[]}));n(s),u(s)}catch(t){console.error(t)}},u=t=>{p({totalOrders:t.length,pending:t.filter(s=>s.status==="pending").length,preparing:t.filter(s=>s.status==="preparing").length,completed:t.filter(s=>s.status==="completed").length,cancelled:t.filter(s=>s.status==="cancelled").length})};d.useEffect(()=>{const t=E(m,{transports:["websocket"]});return b.current=t,t.on("OrderStatus",s=>{n(r=>r.map(l=>l.orderNumber===s.orderNumber?{...l,status:s.status}:l))}),t.on("newOrder",s=>{const r={...s.order,items:s.order.items||[]};n(l=>{const c=[...l,r];return u(c),c})}),t.on("ItemStatus",s=>{s.waiterId===0&&h(`Order #${s.orderNumber} - ${s.name} is ${s.status}`)}),S(),()=>{t.disconnect()}},[m,h]);const k=t=>{const s="px-2 py-1 rounded text-xs font-medium capitalize";switch(t){case"pending":return e.jsx("span",{className:`${s} bg-yellow-100 text-yellow-700`,children:"Pending"});case"preparing":return e.jsx("span",{className:`${s} bg-blue-100 text-blue-700`,children:"Preparing"});case"completed":return e.jsx("span",{className:`${s} bg-green-100 text-green-700`,children:"Completed"});case"cancelled":return e.jsx("span",{className:`${s} bg-red-100 text-red-700`,children:"Cancelled"});default:return e.jsx("span",{className:`${s} bg-gray-100 text-gray-700`,children:t})}},M=t=>t.reduce((s,r)=>s+r.totalPrice,0).toFixed(2),T=async(t,s)=>{try{const r=await g.updateStatus(t.toString(),s);n(l=>{const c=l.map(f=>f.id===t?{...f,status:r.status}:f);return u(c),c}),(a==null?void 0:a.id)===t&&x(r)}catch(r){console.error(r)}},P=async t=>{try{const s=await g.submitCash(t);n(r=>{const l=r.map(c=>c.id===t?{...c,cashCollected:!0}:c);return u(l),l}),(a==null?void 0:a.id)===t&&x(s)}catch(s){console.error(s)}},A=async t=>{if(confirm("Are you sure you want to delete this order?"))try{await g.delete(t.toString()),n(s=>{const r=s.filter(l=>l.id!==t);return u(r),r}),x(null)}catch(s){console.error(s)}},D=F(),$=j?o.filter(t=>t.status===j):o;return e.jsxs("div",{className:"min-h-screen flex bg-gray-100",children:[e.jsx(B,{navigate:D}),e.jsxs("main",{className:"flex-1 p-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Admin Dashboard"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-blue-500",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Orders"}),e.jsx("p",{className:"text-3xl font-bold",children:i.totalOrders})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-yellow-500",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-3xl font-bold",children:i.pending})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-blue-600",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Preparing"}),e.jsx("p",{className:"text-3xl font-bold",children:i.preparing})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-green-500",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Completed"}),e.jsx("p",{className:"text-3xl font-bold",children:i.completed})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 border-l-4 border-red-500",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Cancelled"}),e.jsx("p",{className:"text-3xl font-bold",children:i.cancelled})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Orders"}),e.jsxs("div",{children:[e.jsx("label",{className:"mr-2 font-medium",children:"Filter by status:"}),e.jsxs("select",{value:j,onChange:t=>C(t.target.value),className:"border rounded px-2 py-1",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"preparing",children:"Preparing"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})]}),e.jsxs("table",{className:"w-full border-collapse border border-gray-200",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border p-2 text-left",children:"Order ID"}),e.jsx("th",{className:"border p-2 text-left",children:"Waiter"}),e.jsx("th",{className:"border p-2 text-left",children:"Total Items"}),e.jsx("th",{className:"border p-2 text-left",children:"Total Amount"}),e.jsx("th",{className:"border p-2 text-left",children:"Status"}),e.jsx("th",{className:"border p-2 text-left",children:"Actions"})]})}),e.jsx("tbody",{children:$.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"border p-2",children:["#",t.id]}),e.jsx("td",{className:"border p-2",children:t.waiterId}),e.jsx("td",{className:"border p-2",children:t.items.length}),e.jsxs("td",{className:"border p-2",children:["₹",M(t.items)]}),e.jsx("td",{className:"border p-2",children:k(t.status)}),e.jsxs("td",{className:"border p-2 flex gap-2",children:[e.jsxs("button",{onClick:()=>{x(t),v(!0)},className:"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700",children:[e.jsx(V,{className:"w-4 h-4"})," View"]}),e.jsxs("button",{onClick:()=>{U(t)},className:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700",children:[e.jsx(K,{className:"w-4 h-4"})," Print"]})]})]},t.id))})]})]})]}),e.jsx(_,{open:!!a,onOpenChange:()=>x(null),children:e.jsxs(q,{children:[e.jsx(R,{children:e.jsxs(z,{children:["Order #",a==null?void 0:a.id]})}),e.jsxs("p",{children:[e.jsx("strong",{children:"Waiter:"})," ",a==null?void 0:a.waiter]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",a==null?void 0:a.status]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Total Items:"})," ",a==null?void 0:a.totalItems]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Total Amount:"})," ₹",a==null?void 0:a.totalAmount]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Items:"}),e.jsx("ul",{className:"space-y-1",children:(y=a==null?void 0:a.items)==null?void 0:y.map((t,s)=>e.jsxs("li",{className:"flex justify-between border p-2 rounded-md",children:[e.jsxs("span",{children:[t.name," (",t.quantity,")"]}),e.jsxs("span",{children:["₹",(t.price*t.quantity).toFixed(2)]})]},s))})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(N,{variant:"destructive",onClick:()=>A(a.id),children:"Delete Order"}),(a==null?void 0:a.status)!=="completed"&&e.jsx(N,{onClick:()=>T(a.id,"completed"),children:"Mark as Completed"}),(a==null?void 0:a.cashCollected)===!1&&e.jsx(N,{onClick:()=>P(a.id),children:"Mark Cash Collected"})]})]})})]})},ce=H(Z);export{ce as default};
