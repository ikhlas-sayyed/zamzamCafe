import{w as T,a as n,v as B,p as e}from"./chunk-UH6JLGW7-DB7KfY1H.js";import{C as N,a as h,d as y}from"./card-CF0P5cGQ.js";import{B as i}from"./button-DQc83rjE.js";import{I as S}from"./input-FauOGYKd.js";import{S as E,a as F,b as z,c as H,d}from"./select-xCTCY9o9.js";import{D as V,a as q,b as R}from"./dialog-B_vhg04E.js";import{o as p}from"./api-CIihbRwE.js";import{H as W}from"./Header-DfIEmK8s.js";import{p as M}from"./printBill-75M7aY6S.js";import"./index-C5gdAslh.js";import"./Combination-Dov-rLQ-.js";import"./createLucideIcon-DlhUvwdl.js";import"./index-BZlCCt0w.js";import"./chevron-up-BUQweAlY.js";const ae=T(function(){var g;const[u,C]=n.useState(""),[j,v]=n.useState(""),[c,I]=n.useState(""),[D,m]=n.useState([]),[t,o]=n.useState(null),f=async()=>{try{const s=await p.getOrdersByDate(u,j,c);m(s)}catch(s){console.error(s)}};n.useEffect(()=>{f()},[]);const w=async(s,l)=>{try{const a=await p.updateStatus(s.toString(),l),b=typeof a.id=="string"?parseInt(a.id):a.id;m(r=>r.map(x=>x.id===b?{...x,status:a.status}:x)),o(r=>r&&((typeof r.id=="string"?parseInt(r.id):r.id)===b?{...r,status:a.status}:r))}catch(a){console.error("Failed to update status:",a)}},A=async s=>{if(confirm("Are you sure you want to delete this order?"))try{await p.delete(s.toString()),m(l=>l.filter(a=>a.id!==parseInt(s.toString()))),o(null)}catch(l){console.error(l)}},k=D.filter(s=>!(c&&s.status!==c)),P=B();return e.jsxs("div",{className:"flex",children:[e.jsx(W,{navigate:P}),e.jsxs("main",{className:"flex-1 p-6 space-y-6",children:[e.jsxs(N,{children:[e.jsx(h,{children:e.jsx("h3",{className:"text-lg font-semibold",children:"Filter Orders"})}),e.jsxs(y,{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Start Date"}),e.jsx(S,{type:"date",value:u,onChange:s=>C(s.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"End Date"}),e.jsx(S,{type:"date",value:j,onChange:s=>v(s.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Status"}),e.jsxs(E,{value:c,onValueChange:s=>I(s),children:[e.jsx(F,{children:e.jsx(z,{placeholder:"Select status"})}),e.jsxs(H,{children:[e.jsx(d,{value:"pending",children:"Pending"}),e.jsx(d,{value:"preparing",children:"Preparing"}),e.jsx(d,{value:"ready",children:"Ready"}),e.jsx(d,{value:"completed",children:"Completed"}),e.jsx(d,{value:"cancelled",children:"Cancelled"})]})]})]}),e.jsx(i,{onClick:f,children:"Filter"})]})]}),e.jsxs(N,{children:[e.jsx(h,{children:e.jsx("h3",{className:"text-lg font-semibold",children:"Orders"})}),e.jsx(y,{children:e.jsxs("table",{className:"w-full border-collapse border border-gray-200",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border p-2 text-left",children:"Order ID"}),e.jsx("th",{className:"border p-2 text-left",children:"Total Items"}),e.jsx("th",{className:"border p-2 text-left",children:"Total Amount"}),e.jsx("th",{className:"border p-2 text-left",children:"Waiter"}),e.jsx("th",{className:"border p-2 text-left",children:"Status"}),e.jsx("th",{className:"border p-2 text-left",children:"Actions"})]})}),e.jsx("tbody",{children:k.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"border p-2",children:s.id}),e.jsx("td",{className:"border p-2",children:s.totalItems}),e.jsxs("td",{className:"border p-2",children:["₹",s.totalAmount]}),e.jsx("td",{className:"border p-2",children:s.waiter}),e.jsx("td",{className:"border p-2 capitalize",children:s.status}),e.jsxs("td",{className:"border p-2 space-x-2",children:[e.jsx(i,{size:"sm",variant:"outline",onClick:()=>o(s),children:"View"}),e.jsx(i,{size:"sm",onClick:()=>{M(s)},children:"Print Bill"})]})]},s.id))})]})})]})]}),e.jsx(V,{open:!!t,onOpenChange:()=>o(null),children:e.jsxs(q,{children:[e.jsx(h,{children:e.jsxs(R,{children:["Order #",t==null?void 0:t.id]})}),e.jsxs("p",{children:[e.jsx("strong",{children:"Waiter:"})," ",t==null?void 0:t.waiter]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",t==null?void 0:t.status]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Total Items:"})," ",t==null?void 0:t.totalItems]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Total Amount:"})," ₹",t==null?void 0:t.totalAmount]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Items:"}),e.jsx("ul",{className:"space-y-1",children:(g=t==null?void 0:t.items)==null?void 0:g.map((s,l)=>e.jsxs("li",{className:"flex justify-between border p-2 rounded-md",children:[e.jsxs("span",{children:[s.name," (",s.quantity,")"]}),e.jsxs("span",{children:["₹",(s.price*s.quantity).toFixed(2)]})]},l))})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(i,{variant:"destructive",onClick:()=>A(t.id),children:"Delete Order"}),(t==null?void 0:t.status)!=="completed"&&e.jsx(i,{onClick:()=>w(t.id,"completed"),children:"Mark as Completed"})]})]})})]})});export{ae as default};
